define(["jquery","core/ajax","core/str","core/localstorage","core/url"],function(a,b,c,d,e){var f,g=100,h=0,i=[10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],j=["77","85","93","100","108","116","123.1","131","138.5","146.5","153.9","161.6","167","174","182","189","197"];return{init:function(){f=this;var b=e.relativeUrl("/local/accessibility/userstyles.php");this.sheetnode=a('link[href="'+b+'"]');var c=0,d=0;void 0!==window.localStorage&&(c=window.localStorage.getItem("fontsize"),d=window.localStorage.getItem("colourscheme"),c||window.localStorage.setItem("fontsize",g),d||window.localStorage.setItem("colourscheme",h)),a("#local_accessibility_inc").on("click keypress",this.changeSize),a("#local_accessibility_dec").on("click keypress",this.changeSize),a("#local_accessibility_reset").on("click keypress",this.changeSize),a("#local_accessibility_colour1").on("click keypress",this.changeColor),a("#local_accessibility_colour2").on("click keypress",this.changeColor),a("#local_accessibility_colour3").on("click keypress",this.changeColor),a("#local_accessibility_colour4").on("click keypress",this.changeColor);var i=(new Date).getTime(),j=e.relativeUrl("/local/accessibility/userstyles.php?fontsize="+c+"&colourscheme="+d+"&v="+i);this.sheetnode.attr("href",j)},changeSize:function(a){var b=a.target.id;if(void 0!==window.localStorage){var c=j.indexOf(window.localStorage.getItem("fontsize")),d=i[c];switch(b){case"local_accessibility_inc":d<26&&(d=parseInt(d)+1);break;case"local_accessibility_dec":d>10&&(d=parseInt(d)-1);break;case"local_accessibility_reset":d=13}c=i.indexOf(d),window.localStorage.setItem("fontsize",j[c])}f.reloadStylesheet()},changeColor:function(a){var b=a.target.id;if(void 0!==window.localStorage)switch(b){case"local_accessibility_colour1":window.localStorage.setItem("colourscheme",1);break;case"local_accessibility_colour2":window.localStorage.setItem("colourscheme",2);break;case"local_accessibility_colour3":window.localStorage.setItem("colourscheme",3);break;case"local_accessibility_colour4":window.localStorage.setItem("colourscheme",4)}f.reloadStylesheet()},reloadStylesheet:function(){if(void 0!==window.localStorage){var a=window.localStorage.getItem("fontsize"),b=window.localStorage.getItem("colourscheme"),c=(new Date).getTime(),d=e.relativeUrl("/local/accessibility/userstyles.php?fontsize="+a+"&colourscheme="+b+"&v="+c);this.sheetnode.attr("href",d)}}}});